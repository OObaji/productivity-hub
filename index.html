<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyndArc - Your Productivity Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        // On page load or when changing themes, best to add inline in `head` to avoid FOUC
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark')
        }
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 220px;
            max-height: 250px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 250px;
            }
        }
        .task-checkbox:checked + label span:first-child {
            background-color: #4f46e5; /* indigo-600 */
            border-color: #4f46e5; /* indigo-600 */
        }
        .task-checkbox:checked + label span:first-child svg {
            display: block;
        }
        .task-checkbox:checked + label {
            text-decoration: line-through;
            color: #6b7280; /* gray-500 */
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .landing-page {
            position: relative;
            background-color: #f0f4f8;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }
        #landing-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        .hidden-fade {
            opacity: 0;
            visibility: hidden;
            display: none;
        }
        .visible-fade {
            opacity: 1;
            visibility: visible;
            display: flex; /* Changed for main layout */
        }
        .page-view {
            display: none;
        }
        .page-view.active {
            display: block;
        }
        .kanban-board {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .kanban-board::-webkit-scrollbar {
            display: none; /* Chrome, Safari and Opera */
        }
        .kanban-column {
            flex: 1 0 300px;
        }
        .kanban-card {
            box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px 0 rgba(0,0,0,0.06);
        }
        .sidebar-link.active {
            background-color: #374151; /* gray-700 */
            color: white;
        }
        .sidebar-topics-submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .task-board {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .task-column {
        }
        .task-item {
            box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05);
        }
        .task-item-checkbox:checked + label {
            text-decoration: line-through;
            color: #6b7280;
        }
        
        #pomodoro.page-view, #shift-timer.page-view {
            background-size: cover;
            background-position: center;
            transition: background-color 0.5s ease-in-out, background-image 0.5s ease-in-out;
        }
        .overlay {
            background-color: rgba(0,0,0,0.5);
        }
        #pomodoro-timer-container {
            width: 320px;
            height: 320px;
            position: relative;
        }
        #pomodoro-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        #pomodoro-controls {
            position: relative;
            z-index: 10;
        }
        input[type="datetime-local"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #shift-timer-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        #idea-board {
            background-image: url('https://www.transparenttextures.com/patterns/cork-wallet.png');
            background-color: #d2b48c;
        }
        .sticky-note {
            box-shadow: 5px 5px 7px rgba(33,33,33,.7);
            transition: transform .15s linear;
            cursor: grab;
            resize: both;
            overflow: hidden;
        }
        .sticky-note.dragging {
            transform: scale(1.05);
            z-index: 50;
            cursor: grabbing;
        }
        #add-note-btn {
            cursor: grab;
        }
        #add-note-btn:active {
            cursor: grabbing;
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-gray-900 text-slate-800 dark:text-slate-200">

    <section id="landing-page" class="landing-page h-screen w-full flex items-center justify-center text-center p-4">
        <canvas id="landing-canvas"></canvas>
        <div class="relative z-10 max-w-3xl">
            <h1 class="text-5xl md:text-7xl font-bold text-slate-900 tracking-tight">Find Your Focus.</h1>
            <p class="mt-4 text-lg text-slate-600">A central hub for all your tasks, goals, and learning. Organize your life and achieve more, one day at a time.</p>
            <button id="get-started-btn" class="mt-8 px-8 py-4 bg-indigo-600 text-white font-semibold rounded-lg shadow-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75 transform hover:scale-105 transition-transform duration-200">
                Enter Hub
            </button>
        </div>
    </section>

    <div id="app-layout" class="hidden-fade h-screen">
        <!-- Sidebar -->
        <nav id="sidebar" class="w-64 bg-gray-800 text-gray-300 flex-shrink-0 flex-col h-full p-4 fixed lg:relative lg:flex z-20 -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out">
            <div class="flex items-center justify-between mb-8">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                    </div>
                    <span class="font-bold text-xl text-white">Productivity Hub</span>
                </div>
                <button id="close-sidebar-btn" class="lg:hidden">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>

            <div class="flex-grow overflow-y-auto">
                <a href="#" class="sidebar-link nav-link flex items-center p-2 rounded-lg hover:bg-gray-700 active" data-view="dashboard-home">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                    Dashboard
                </a>
                
                <div class="mt-2">
                    <button id="topics-toggle-btn" class="sidebar-link w-full flex items-center p-2 rounded-lg hover:bg-gray-700">
                        <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" /></svg>
                        Summer Topics
                        <svg id="topics-arrow" class="w-4 h-4 ml-auto transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="topics-submenu" class="sidebar-topics-submenu pl-8 mt-1 space-y-1">
                        <a href="#" class="block text-sm p-1 rounded hover:bg-gray-700 topic-filter" data-module="all">All Topics</a>
                        <a href="#" class="block text-sm p-1 rounded hover:bg-gray-700 topic-filter" data-module="Immersive Technology">Immersive Tech</a>
                        <a href="#" class="block text-sm p-1 rounded hover:bg-gray-700 topic-filter" data-module="AI & Machine Learning">Intelligent Systems</a>
                        <a href="#" class="block text-sm p-1 rounded hover:bg-gray-700 topic-filter" data-module="Mobile & Ubiquitous Technology">Mobile & Ubiquitous</a>
                        <a href="#" class="block text-sm p-1 rounded hover:bg-gray-700 topic-filter" data-module="Cyber Security">Cyber Security</a>
                    </div>
                </div>

                <a href="#" class="sidebar-link nav-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700" data-view="pomodoro">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    Pomodoro Timer
                </a>
                <a href="#" class="sidebar-link nav-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700" data-view="schedule">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                    Schedule
                </a>
                <a href="#" class="sidebar-link nav-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700" data-view="spotify">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 6l12-3" /></svg>
                    Spotify
                </a>
                 <a href="#" class="sidebar-link nav-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700" data-view="dissertation">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                    Dissertation
                </a>
                <a href="#" class="sidebar-link nav-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700" data-view="weekly-goals">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" /></svg>
                    Weekly Goals
                </a>
                <a href="#" class="sidebar-link nav-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700" data-view="shift-timer">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    Shift Timer
                </a>
                <div class="mt-2">
                    <button id="tools-toggle-btn" class="sidebar-link w-full flex items-center p-2 rounded-lg hover:bg-gray-700">
                       <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                        Tools
                        <svg id="tools-arrow" class="w-4 h-4 ml-auto transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="tools-submenu" class="sidebar-topics-submenu pl-8 mt-1 space-y-1">
                        <a href="#" class="nav-link flex items-center p-1 rounded-lg hover:bg-gray-700" data-view="hour-calculator">
                           <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                            Hour Calculator
                        </a>
                        <a href="#" class="nav-link flex items-center p-1 rounded-lg hover:bg-gray-700" data-view="idea-board">
                           <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707m-9.192 9.192l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                            Idea Board
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 pt-4">
                 <a href="#" class="sidebar-link nav-link flex items-center p-2 rounded-lg hover:bg-gray-700" data-view="settings">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                    Settings
                </a>
                 <a href="#" id="logout-btn" class="sidebar-link flex items-center p-2 mt-2 rounded-lg hover:bg-gray-700">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                    Log Out
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 h-full overflow-y-auto bg-slate-50 dark:bg-gray-800">
             <header class="p-4 bg-white dark:bg-gray-800 shadow-md lg:hidden flex justify-between items-center sticky top-0 z-10">
                <span class="font-bold text-xl text-indigo-600">Productivity Hub</span>
                <button id="open-sidebar-btn">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </header>
            <div id="main-content-wrapper" class="h-full">
                <div id="dashboard-home" class="page-view active container mx-auto px-4 sm:px-6 py-8">
                    <header class="text-center mb-8">
                        <h1 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white">Summer Curriculum Dashboard</h1>
                        <p class="mt-2 text-slate-600 dark:text-slate-400">Your interactive roadmap to mastering key technology domains.</p>
                        <p class="mt-1 text-sm text-slate-500 dark:text-slate-500" id="endDateText"></p>
                    </header>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm mb-8 md:mb-12">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-semibold text-slate-700 dark:text-slate-300">Overall Progress</span>
                            <span id="progress-percent" class="font-semibold text-indigo-600 dark:text-indigo-400">0%</span>
                        </div>
                        <div class="w-full bg-slate-200 dark:bg-gray-700 rounded-full h-2 my-2">
                            <div id="progress-bar" class="bg-indigo-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="flex justify-between text-sm text-slate-500 dark:text-slate-400">
                            <span id="progress-subtext">0 of 0 tasks completed</span>
                            <span>üöÄ</span>
                        </div>
                    </div>
                    <section class="mb-12 p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-sm">
                        <h2 class="text-xl font-bold text-slate-800 dark:text-white mb-4 text-center">Learning Timeline</h2>
                        <div class="chart-container">
                            <canvas id="timelineChart"></canvas>
                        </div>
                    </section>
                    <main id="curriculum-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                    </main>
                </div>

                <div id="pomodoro" class="page-view h-full">
                    <div class="overlay flex flex-col items-center justify-center h-full p-4 text-white">
                        <div class="w-full max-w-md bg-white/10 backdrop-blur-md p-6 rounded-2xl mb-6">
                            <label for="focus-task-input" class="text-sm font-medium text-gray-300">What is your main focus?</label>
                            <input id="focus-task-input" type="text" placeholder="e.g., Finish chapter on Neural Networks" class="w-full bg-transparent border-b-2 border-gray-400 focus:border-white focus:outline-none py-2 mt-1 text-lg">
                        </div>
                        <div id="pomodoro-timer-container" class="bg-white/10 backdrop-blur-md rounded-full p-6 flex flex-col items-center justify-between shadow-2xl">
                            <div class="relative flex items-center justify-center w-full h-full">
                                <canvas id="pomodoro-canvas" class="absolute top-0 left-0" width="270" height="270"></canvas>
                                <div id="pomodoro-controls" class="absolute flex flex-col items-center">
                                    <span id="pomodoro-icon" class="text-4xl">üçÖ</span>
                                    <div id="pomodoro-time" class="text-6xl font-bold my-1">25:00</div>
                                    <div id="pomodoro-mode" class="text-lg tracking-widest uppercase">Focus</div>
                                    <button id="pomodoro-play-pause" class="mt-2">
                                        <svg id="play-icon" class="w-12 h-12" fill="currentColor" viewBox="0 0 20 20"><path d="M4.018 15.59a.5.5 0 00.816.372l10-7a.5.5 0 000-.744l-10-7A.5.5 0 004 2v13.59z" /></svg>
                                        <svg id="pause-icon" class="w-12 h-12 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z" /></svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4 mt-6">
                            <button id="pomodoro-switch-mode" class="px-8 py-3 bg-white/20 backdrop-blur-md rounded-full font-semibold uppercase tracking-wider">Take a Break</button>
                            <div class="text-center">
                                <div id="pomodoro-session-count" class="text-2xl font-bold">0</div>
                                <div class="text-sm">Sessions</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="schedule" class="page-view container mx-auto px-4 sm:px-6 py-8">
                     <div class="max-w-4xl mx-auto bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-sm">
                        <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-4">My Schedule</h2>
                        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg mb-4" role="alert">
                          <p class="font-bold">Action Required</p>
                          <p>To view your Google Calendar, you need to get the embed code. Go to your Google Calendar settings, find the "Integrate calendar" section, copy the "Embed code", and paste the `src` URL into the `iframe` below in the HTML.</p>
                        </div>
                        <iframe src="https://calendar.google.com/calendar/embed?src=en.uk%23holiday%40group.v.calendar.google.com" style="border: 0" width="100%" height="600" frameborder="0" scrolling="no"></iframe>
                    </div>
                </div>

                <div id="spotify" class="page-view container mx-auto px-4 sm:px-6 py-8">
                     <div class="max-w-5xl mx-auto bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-sm">
                        <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-4">Focus Playlist</h2>
                        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg mb-4" role="alert">
                          <p class="font-bold">Action Required</p>
                          <p>To use your own playlist, go to Spotify, click the "..." on a playlist, select "Share", then "Embed playlist", and paste the `src` URL into the `iframe` below in the HTML.</p>
                        </div>
                        <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" width="100%" height="580" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                    </div>
                </div>

                <div id="dissertation" class="page-view container mx-auto px-4 sm:px-6 py-8">
                    <h1 class="text-3xl font-bold text-slate-900 dark:text-white mb-6">Dissertation Command Center</h1>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 space-y-6">
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm">
                                <h2 class="text-xl font-bold mb-4 dark:text-white">1. Project Overview</h2>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                    <div><strong>Title:</strong> The Impact of AI on Immersive Learning Environments</div>
                                    <div><strong>Supervisor:</strong> Dr. Evelyn Reed</div>
                                    <div><strong>Course:</strong> MSc Advanced Computer Science</div>
                                    <div><strong>Department:</strong> School of Engineering</div>
                                    <div><strong>Start Date:</strong> 01 July 2025</div>
                                    <div><strong>Deadline:</strong> <span id="dissertation-deadline-text">01 May 2026</span></div>
                                </div>
                                <p class="text-sm mt-4 text-slate-600 dark:text-slate-400"><strong>Summary:</strong> An investigation into how artificial intelligence can be leveraged to create more adaptive, personalized, and effective virtual reality experiences for educational purposes.</p>
                                <div class="mt-4">
                                    <div class="flex justify-between mb-1">
                                        <span class="text-base font-medium text-indigo-700 dark:text-indigo-400">Overall Progress</span>
                                        <span class="text-sm font-medium text-indigo-700 dark:text-indigo-400" id="writing-progress-percentage">30%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                                        <div id="writing-progress-bar" class="bg-indigo-600 h-2.5 rounded-full" style="width: 30%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm">
                                <h2 class="text-xl font-bold mb-4 dark:text-white">‚ú® 2. AI Research Assistant</h2>
                                <div class="space-y-3">
                                    <textarea id="ai-research-query" class="w-full p-2 border rounded-md text-sm bg-gray-100 dark:bg-gray-700 dark:text-white" placeholder="Ask a research question... e.g., 'Summarize key arguments for using VR in medical training'"></textarea>
                                    <button id="ai-research-btn" class="w-full px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center justify-center">
                                        <span id="ai-research-btn-text">Generate Insights</span>
                                        <div id="ai-research-loader" class="loader hidden ml-2"></div>
                                    </button>
                                    <div id="ai-research-output" class="mt-4 p-4 bg-slate-50 dark:bg-gray-700 rounded-lg text-sm text-slate-700 dark:text-slate-300 min-h-[100px]"></div>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-6">
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm text-center">
                                <h2 class="text-lg font-bold mb-2 dark:text-white">7. Countdown to Submission</h2>
                                <div id="countdown-timer" class="text-4xl font-bold text-rose-600"></div>
                                <p class="text-sm text-slate-500 dark:text-slate-400">days remaining</p>
                            </div>
                            <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm">
                                <h2 class="text-lg font-bold mb-2 dark:text-white">8. Motivation Zone</h2>
                                <p class="text-slate-600 dark:text-slate-400 italic">"The secret of getting ahead is getting started."</p>
                                <p class="text-right text-sm font-semibold text-slate-700 dark:text-slate-300 mt-1">- Mark Twain</p>
                            </div>
                             <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm">
                                <h2 class="text-lg font-bold mb-2 dark:text-white">4. Resources</h2>
                                <ul class="space-y-2 text-sm list-disc list-inside">
                                    <li><a href="#" class="text-indigo-600 dark:text-indigo-400 hover:underline">Key Paper on VR Pedagogy</a></li>
                                    <li><a href="#" class="text-indigo-600 dark:text-indigo-400 hover:underline">AI in Education Review</a></li>
                                    <li><a href="#" class="text-indigo-600 dark:text-indigo-400 hover:underline">Zotero Library Link</a></li>
                                </ul>
                            </div>
                        </div>
                         <div class="lg:col-span-3 bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm">
                            <h2 class="text-xl font-bold mb-4 text-center dark:text-white">5. Task Board</h2>
                            <div class="kanban-board">
                                <div class="kanban-column bg-slate-100 dark:bg-gray-700">
                                    <h3 class="font-bold mb-4 dark:text-white">To Do</h3>
                                    <div class="kanban-card bg-white dark:bg-gray-900">Read paper on immersive UX</div>
                                    <div class="kanban-card bg-white dark:bg-gray-900">Schedule supervisor meeting</div>
                                </div>
                                <div class="kanban-column bg-slate-100 dark:bg-gray-700">
                                    <h3 class="font-bold mb-4 dark:text-white">In Progress</h3>
                                    <div class="kanban-card bg-white dark:bg-gray-900">Finish Lit Review</div>
                                     <div class="kanban-card bg-white dark:bg-gray-900">Draft research questions</div>
                                </div>
                                <div class="kanban-column bg-slate-100 dark:bg-gray-700">
                                    <h3 class="font-bold mb-4 dark:text-white">Done</h3>
                                    <div class="kanban-card bg-white dark:bg-gray-900">Topic selected</div>
                                    <div class="kanban-card bg-white dark:bg-gray-900">Proposal submitted</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="weekly-goals" class="page-view container mx-auto px-4 sm:px-6 py-8">
                    <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-2">Weekly Goals</h2>
                    <p class="text-slate-500 dark:text-slate-400 mb-6">Organize your week. Add high-level tasks and use AI to break them down into smaller steps.</p>
                    <div class="task-board">
                        <!-- Columns will be generated by JS -->
                    </div>
                </div>
                
                <div id="shift-timer" class="page-view h-full relative">
                    <canvas id="shift-timer-canvas" class="absolute top-0 left-0 w-full h-full"></canvas>
                    <div class="relative z-10 flex flex-col items-center justify-center h-full p-4 text-white">
                        <div id="shift-setup" class="w-full max-w-md bg-black/30 backdrop-blur-md p-8 rounded-2xl text-center">
                            <h2 class="text-2xl font-bold mb-4">Set Shift End Time</h2>
                            <input type="datetime-local" id="shift-end-time-input" class="w-full p-2 rounded-lg bg-gray-700 text-white border-gray-600">
                             <div class="mt-4 grid grid-cols-2 gap-2 text-sm">
                                <button id="preset-normal-btn" class="p-2 bg-indigo-500/50 rounded-lg">Normal Shift (7AM)</button>
                                <button id="preset-overtime-btn" class="p-2 bg-indigo-500/50 rounded-lg">Overtime (5AM)</button>
                            </div>
                            <button id="start-shift-btn" class="mt-8 w-full px-8 py-3 bg-yellow-500 text-gray-900 font-semibold rounded-lg shadow-lg hover:bg-yellow-400">Start Shift</button>
                        </div>

                        <div id="shift-countdown-display" class="hidden text-center">
                            <h2 id="shift-motivation-quote" class="text-2xl font-semibold tracking-wider mb-4">Let's get this bread!</h2>
                            <div class="flex items-center justify-center my-4 text-yellow-400" style="text-shadow: 0 0 10px rgba(250, 204, 21, 0.5);">
                                <div class="mx-2">
                                    <div id="shift-hours-display" class="text-8xl md:text-9xl font-bold">00</div>
                                    <div class="text-sm uppercase tracking-widest">Hours</div>
                                </div>
                                <div class="text-7xl font-bold">:</div>
                                <div class="mx-2">
                                    <div id="shift-minutes-display" class="text-8xl md:text-9xl font-bold">00</div>
                                    <div class="text-sm uppercase tracking-widest">Minutes</div>
                                </div>
                                <div class="text-7xl font-bold">:</div>
                                <div class="mx-2">
                                    <div id="shift-seconds-display" class="text-8xl md:text-9xl font-bold">00</div>
                                    <div class="text-sm uppercase tracking-widest">Seconds</div>
                                </div>
                            </div>
                            <div class="w-full max-w-2xl mx-auto mt-4">
                                <div class="w-full bg-white/20 rounded-full h-2.5">
                                    <div id="shift-progress-bar" class="bg-yellow-400 h-2.5 rounded-full" style="width: 0%"></div>
                                </div>
                                <div class="flex justify-between text-xs mt-1">
                                    <span>Shift Started</span>
                                    <span id="shift-end-time-label"></span>
                                </div>
                            </div>
                             <button id="reset-shift-btn" class="mt-8 px-8 py-3 bg-white/20 backdrop-blur-md rounded-full font-semibold uppercase tracking-wider">Reset Shift</button>
                        </div>
                        
                        <div id="shift-end-message" class="hidden text-center max-w-lg">
                            <h2 class="text-4xl font-bold">Congratulations!</h2>
                            <p class="text-xl mt-4">Your shift has now ended. It's time to rest.</p>
                            <button id="new-shift-btn" class="mt-8 px-8 py-3 bg-yellow-500 text-gray-900 font-semibold rounded-lg shadow-lg hover:bg-yellow-400">Start New Shift</button>
                        </div>
                    </div>
                </div>

                 <div id="hour-calculator" class="page-view container mx-auto px-4 sm:px-6 py-8">
                    <h1 class="text-3xl font-bold text-slate-900 dark:text-white mb-4">Hour Calculator</h1>
                    <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm">
                            <h2 class="text-lg font-semibold text-white bg-blue-600 -mx-6 -mt-6 mb-6 px-6 py-3 rounded-t-lg">Enter Time:</h2>
                            <div id="time-entries" class="space-y-2">
                                <!-- Time entries will be generated here -->
                            </div>
                            <button id="add-time-row" class="mt-4 text-blue-600 dark:text-blue-400 hover:underline text-sm font-semibold">+ Add More Lines</button>
                        </div>
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm">
                            <h2 class="text-lg font-semibold text-white bg-blue-600 -mx-6 -mt-6 mb-6 px-6 py-3 rounded-t-lg">See Your Total:</h2>
                             <div class="space-y-4">
                                <div class="bg-gray-200 dark:bg-gray-700 p-4 rounded-lg text-center">
                                    <div id="total-time-hms" class="text-3xl font-bold text-gray-800 dark:text-white">00:00:00</div>
                                    <div class="text-sm text-gray-500 dark:text-gray-400">HH:MM:SS</div>
                                </div>
                                <div class="bg-gray-200 dark:bg-gray-700 p-4 rounded-lg text-center">
                                    <div id="total-time-decimal" class="text-3xl font-bold text-gray-800 dark:text-white">0.00</div>
                                     <div class="text-sm text-gray-500 dark:text-gray-400">In Hours</div>
                                </div>
                                <button id="calculate-time-btn" class="w-full py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700">Calculate</button>
                                <button id="clear-time-btn" class="w-full py-3 bg-gray-600 text-white font-bold rounded-lg hover:bg-gray-700">Clear</button>
                                <button id="print-time-btn" class="w-full py-3 bg-gray-600 text-white font-bold rounded-lg hover:bg-gray-700">Print</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="settings" class="page-view container mx-auto px-4 sm:px-6 py-8">
                     <h1 class="text-3xl font-bold text-slate-900 dark:text-white mb-6">Settings</h1>
                     <div class="space-y-8 max-w-2xl mx-auto">
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm">
                            <h2 class="text-xl font-semibold mb-4 border-b pb-2 dark:border-gray-700">Appearance</h2>
                            <div class="flex items-center justify-between">
                                <label for="dark-mode-toggle" class="font-medium text-slate-700 dark:text-slate-300">Dark Mode</label>
                                <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5">
                                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 100 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                                </button>
                            </div>
                        </div>
                     </div>
                </div>
                <div id="idea-board" class="page-view h-full relative overflow-hidden">
                    <div id="idea-board-container" class="w-full h-full"></div>
                    <button id="add-note-btn" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 px-6 py-3 bg-yellow-400 text-gray-800 font-semibold rounded-full shadow-lg hover:bg-yellow-500 z-20">
                        + Add Note
                    </button>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Add Task Modal -->
    <div id="add-task-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-md">
            <h3 class="text-lg font-bold mb-4" id="modal-title">Add New Task</h3>
            <div class="flex gap-2">
                <input type="text" id="modal-task-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Enter a large goal...">
                <button id="ai-breakdown-btn" class="p-2 bg-indigo-500 text-white rounded-md flex items-center justify-center">
                    <span id="ai-breakdown-btn-text">‚ú®</span>
                    <div id="ai-breakdown-loader" class="loader hidden"></div>
                </button>
            </div>
            <div class="mt-4 flex justify-end space-x-2">
                <button id="modal-cancel-btn" class="px-4 py-2 bg-gray-200 rounded-md">Cancel</button>
                <button id="modal-save-btn" class="px-4 py-2 bg-indigo-600 text-white rounded-md">Add Manually</button>
            </div>
        </div>
    </div>


    <script>
        const curriculumData = [
            {
                module: "Immersive Technology",
                themeColor: "blue",
                icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9.75l-9-5.25M12 12.75l9 5.25" />`,
                description: "Master the fundamentals of VR/AR development using industry-standard engines like Unity and Unreal.",
                topics: [
                    { title: "Foundations of VR/AR", items: ["Core Concepts (VR/AR/MR)", "Unity & XR Interaction Toolkit", "Unreal Engine VR Template"] },
                    { title: "Advanced Interaction", items: ["Physics-based Interactions", "Hand Tracking", "UI/UX for VR"] },
                ]
            },
            {
                module: "AI & Machine Learning",
                themeColor: "purple",
                icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.25 3.75H19.5M8.25 3.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM8.25 9.75H19.5M8.25 9.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM8.25 15.75H19.5M8.25 15.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0z" />`,
                description: "Explore the world of artificial intelligence, from foundational models to practical machine learning applications.",
                topics: [
                    { title: "ML Fundamentals", items: ["Supervised vs. Unsupervised Learning", "Intro to Neural Networks", "Data Preprocessing"] },
                    { title: "Practical AI", items: ["Working with TensorFlow or PyTorch", "Natural Language Processing (NLP) Basics", "Computer Vision Basics"] },
                ]
            },
            {
                module: "Advanced Web Technology",
                themeColor: "emerald",
                icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" />`,
                description: "Build modern, high-performance web applications using advanced frontend and backend technologies.",
                topics: [
                    { title: "Modern Frontend", items: ["Deep Dive into a JS Framework (React/Vue/Svelte)", "State Management Patterns", "Web Performance Optimization"] },
                    { title: "Backend & APIs", items: ["Building RESTful APIs with Node.js/Express", "Database Fundamentals (SQL/NoSQL)", "Authentication & Authorization"] },
                ]
            },
            {
                module: "Mobile & Ubiquitous Technology",
                themeColor: "amber",
                icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.5 1.5H8.25A2.25 2.25 0 006 3.75v16.5a2.25 2.25 0 002.25 2.25h7.5A2.25 2.25 0 0018 20.25V3.75a2.25 2.25 0 00-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />`,
                description: "Develop applications for mobile devices and understand the principles of computing everywhere.",
                topics: [
                    { title: "Native & Cross-Platform Dev", items: ["Intro to Swift (iOS) or Kotlin (Android)", "Exploring React Native or Flutter", "Mobile UI/UX Design Principles"] },
                    { title: "Ubiquitous Computing", items: ["IoT Basics & Sensor Networks", "Context-Aware Applications", "Wearable Technology"] },
                ]
            },
            {
                module: "Cyber Security",
                themeColor: "rose",
                icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.286zm0 13.036h.008v.008h-.008v-.008z" />`,
                description: "Learn to protect systems, networks, and programs from digital attacks with fundamental security principles.",
                topics: [
                    { title: "Security Principles", items: ["Core Concepts (CIA Triad)", "Network Security Basics", "Cryptography Fundamentals"] },
                    { title: "Ethical Hacking & Defense", items: ["Vulnerability Assessment", "Penetration Testing Methodologies", "Defensive Security & Incident Response"] },
                ]
            }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const getStartedBtn = document.getElementById('get-started-btn');
            const landingPage = document.getElementById('landing-page');
            const appLayout = document.getElementById('app-layout');
            const logoutBtn = document.getElementById('logout-btn');
            const openSidebarBtn = document.getElementById('open-sidebar-btn');
            const closeSidebarBtn = document.getElementById('close-sidebar-btn');
            const sidebar = document.getElementById('sidebar');
            const landingCanvas = document.getElementById('landing-canvas');
            
            const grid = document.getElementById('curriculum-grid');
            const endDateText = document.getElementById('endDateText');
            endDateText.textContent = `End Date: 31/08/2025`;

            let totalTasks = 0;
            let dashboardInitialized = false;
            let timelineChart = null;

            function initializeDashboard() {
                if (dashboardInitialized) return;

                curriculumData.forEach((moduleData, moduleIndex) => {
                    const moduleCard = document.createElement('div');
                    moduleCard.className = `module-card bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6 flex flex-col`;
                    moduleCard.dataset.module = moduleData.module;

                    let topicsHtml = '';
                    moduleData.topics.forEach((topic, topicIndex) => {
                        let itemsHtml = '<ul class="space-y-3 pt-4">';
                        topic.items.forEach((item, itemIndex) => {
                            const checkboxId = `task-${moduleIndex}-${topicIndex}-${itemIndex}`;
                            totalTasks++;
                            itemsHtml += `
                                <li class="flex items-start">
                                    <input type="checkbox" id="${checkboxId}" class="task-checkbox hidden">
                                    <label for="${checkboxId}" class="flex items-center cursor-pointer text-slate-700 dark:text-slate-300 w-full">
                                        <span class="w-5 h-5 mr-3 rounded border-2 border-slate-300 dark:border-gray-600 flex-shrink-0 flex items-center justify-center">
                                            <svg class="w-3.5 h-3.5 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                        </span>
                                        ${item}
                                    </label>
                                </li>
                            `;
                        });
                        itemsHtml += '</ul>';

                        topicsHtml += `
                            <div class="border-b border-slate-200 dark:border-gray-700 last:border-b-0">
                                <button class="accordion-toggle w-full flex justify-between items-center py-4 text-left">
                                    <h4 class="font-semibold text-slate-800 dark:text-white">${topic.title}</h4>
                                    <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </button>
                                <div class="accordion-content">
                                    ${itemsHtml}
                                </div>
                            </div>
                        `;
                    });
                    
                    moduleCard.innerHTML = `
                        <div>
                            <div class="w-12 h-12 rounded-lg bg-${moduleData.themeColor}-100 flex items-center justify-center mb-4">
                                <svg class="w-6 h-6 text-${moduleData.themeColor}-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">${moduleData.icon}</svg>
                            </div>
                            <h3 class="text-xl font-bold text-slate-900 dark:text-white">${moduleData.module}</h3>
                            <p class="text-slate-600 dark:text-slate-400 mt-2 mb-4 h-24">${moduleData.description}</p>
                        </div>
                        <div class="flex-grow">
                            ${topicsHtml}
                        </div>
                    `;
                    grid.appendChild(moduleCard);
                });

                document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', updateProgress);
                });
                
                document.querySelectorAll('.accordion-toggle').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        const icon = button.querySelector('svg');

                        if (content.style.maxHeight) {
                            content.style.maxHeight = null;
                            icon.classList.remove('rotate-180');
                        } else {
                            document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                            document.querySelectorAll('.accordion-toggle svg').forEach(i => i.classList.remove('rotate-180'));

                            content.style.maxHeight = content.scrollHeight + "px";
                            icon.classList.add('rotate-180');
                        }
                    });
                });

                updateProgress();
                renderTimelineChart();
                setupNavigation();
                setupPomodoro();
                setupWeeklyGoals();
                setupDissertationPage();
                setupShiftTimer();
                setupHourCalculator();
                setupIdeaBoard();
                setupSettings();
                dashboardInitialized = true;
            }

            const updateProgress = () => {
                const checkedTasks = document.querySelectorAll('.task-checkbox:checked').length;
                const progress = totalTasks > 0 ? (checkedTasks / totalTasks) * 100 : 0;
                
                document.getElementById('progress-bar').style.width = `${progress}%`;
                document.getElementById('progress-percent').textContent = `${Math.round(progress)}%`;
                document.getElementById('progress-subtext').textContent = `${checkedTasks} of ${totalTasks} tasks completed`;
            };
            
            getStartedBtn.addEventListener('click', () => {
                initializeDashboard();
                landingPage.style.opacity = 0;
                setTimeout(() => {
                    landingPage.style.display = 'none';
                    appLayout.classList.remove('hidden-fade');
                    appLayout.classList.add('visible-fade');
                }, 500);
            });

            logoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                appLayout.style.opacity = 0;
                setTimeout(() => {
                    appLayout.classList.add('hidden-fade');
                    appLayout.classList.remove('visible-fade');
                    
                    landingPage.style.display = 'flex';
                    setTimeout(() => {
                        landingPage.style.opacity = 1;
                    }, 50);
                }, 500);
            });
            
            function setupNavigation() {
                const navLinks = document.querySelectorAll('.nav-link');
                const pageViews = document.querySelectorAll('.page-view');
                const sidebarLinks = document.querySelectorAll('.sidebar-link');
                const topicsToggleBtn = document.getElementById('topics-toggle-btn');
                const topicsSubmenu = document.getElementById('topics-submenu');
                const toolsToggleBtn = document.getElementById('tools-toggle-btn');
                const toolsSubmenu = document.getElementById('tools-submenu');
                const topicsArrow = document.getElementById('topics-arrow');
                const toolsArrow = document.getElementById('tools-arrow');
                const topicFilters = document.querySelectorAll('.topic-filter');
                const mainContentWrapper = document.getElementById('main-content-wrapper');

                openSidebarBtn.addEventListener('click', () => sidebar.classList.remove('-translate-x-full'));
                closeSidebarBtn.addEventListener('click', () => sidebar.classList.add('-translate-x-full'));

                function setActiveLink(clickedLink) {
                    sidebarLinks.forEach(link => link.classList.remove('active'));
                    if (clickedLink) {
                       clickedLink.classList.add('active');
                    }
                }

                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const view = link.dataset.view;
                        
                        pageViews.forEach(page => {
                           if(page.id === view) {
                               page.classList.add('active');
                               if (page.id === 'pomodoro' || page.id === 'shift-timer' || page.id === 'idea-board') {
                                   mainContentWrapper.classList.remove('container', 'mx-auto', 'px-4', 'sm:px-6', 'py-8');
                               } else {
                                   mainContentWrapper.classList.add('container', 'mx-auto', 'px-4', 'sm:px-6', 'py-8');
                               }
                           } else {
                               page.classList.remove('active');
                           }
                        });
                        
                        setActiveLink(link);
                        sidebar.classList.add('-translate-x-full');
                    });
                });

                topicsToggleBtn.addEventListener('click', () => {
                    if (topicsSubmenu.style.maxHeight) {
                        topicsSubmenu.style.maxHeight = null;
                        topicsArrow.classList.remove('rotate-180');
                    } else {
                        topicsSubmenu.style.maxHeight = topicsSubmenu.scrollHeight + "px";
                        topicsArrow.classList.add('rotate-180');
                    }
                });
                
                toolsToggleBtn.addEventListener('click', () => {
                    if (toolsSubmenu.style.maxHeight) {
                        toolsSubmenu.style.maxHeight = null;
                        toolsArrow.classList.remove('rotate-180');
                    } else {
                        toolsSubmenu.style.maxHeight = toolsSubmenu.scrollHeight + "px";
                        toolsArrow.classList.add('rotate-180');
                    }
                });

                topicFilters.forEach(filter => {
                    filter.addEventListener('click', (e) => {
                        e.preventDefault();
                        const moduleToShow = filter.dataset.module;
                        
                        pageViews.forEach(p => p.classList.remove('active'));
                        document.getElementById('dashboard-home').classList.add('active');
                        setActiveLink(document.querySelector('.nav-link[data-view="dashboard-home"]'));
                         mainContentWrapper.classList.add('container', 'mx-auto', 'px-4', 'sm:px-6', 'py-8');

                        document.querySelectorAll('.module-card').forEach(card => {
                            card.style.display = (moduleToShow === 'all' || card.dataset.module === moduleToShow) ? 'flex' : 'none';
                        });
                        sidebar.classList.add('-translate-x-full');
                    });
                });
            }
            
            function setupPomodoro() {
                const pomodoroPage = document.getElementById('pomodoro');
                const modes = {
                    pomodoro: {
                        name: 'Focus',
                        time: 25,
                        color: '#F97316', // orange-500
                        icon: 'üçÖ',
                        next: 'shortBreak',
                        background: 'https://images.unsplash.com/photo-1484417894907-623942c8ee29?q=80&w=3132&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
                    },
                    shortBreak: {
                        name: 'Relax',
                        time: 5,
                        color: '#3B82F6', // blue-500
                        icon: '‚òï',
                        next: 'pomodoro',
                        background: 'https://images.unsplash.com/photo-1447752875215-b2761acb3c5d?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
                    },
                };

                let timer;
                let currentMode = 'pomodoro';
                let totalSeconds = modes[currentMode].time * 60;
                let remainingSeconds = totalSeconds;
                let isPaused = true;
                let sessionCount = 0;

                const canvas = document.getElementById('pomodoro-canvas');
                const ctx = canvas.getContext('2d');
                const timeDisplay = document.getElementById('pomodoro-time');
                const modeDisplay = document.getElementById('pomodoro-mode');
                const iconDisplay = document.getElementById('pomodoro-icon');
                const playPauseBtn = document.getElementById('pomodoro-play-pause');
                const playIcon = document.getElementById('play-icon');
                const pauseIcon = document.getElementById('pause-icon');
                const switchModeBtn = document.getElementById('pomodoro-switch-mode');
                const sessionCountDisplay = document.getElementById('pomodoro-session-count');

                function drawCircle(progress) {
                    const centerX = canvas.width / 2;
                    const centerY = canvas.height / 2;
                    const radius = canvas.width / 2 - 10;

                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                    ctx.lineWidth = 12;
                    ctx.stroke();

                    if (progress > 0) {
                        ctx.beginPath();
                        ctx.arc(centerX, centerY, radius, -0.5 * Math.PI, (progress * 2 * Math.PI) - 0.5 * Math.PI);
                        ctx.strokeStyle = modes[currentMode].color;
                        ctx.lineWidth = 12;
                        ctx.lineCap = 'round';
                        ctx.stroke();
                    }
                }

                function updateDisplay() {
                    const minutes = Math.floor(remainingSeconds / 60);
                    const seconds = remainingSeconds % 60;
                    timeDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    const progress = (totalSeconds - remainingSeconds) / totalSeconds;
                    drawCircle(progress);
                }
                
                function setMode(modeKey) {
                    currentMode = modeKey;
                    const mode = modes[currentMode];
                    totalSeconds = mode.time * 60;
                    remainingSeconds = totalSeconds;
                    modeDisplay.textContent = mode.name;
                    iconDisplay.textContent = mode.icon;
                    switchModeBtn.textContent = mode.next === 'pomodoro' ? 'Start Focus' : 'Take a Break';
                    pomodoroPage.style.backgroundImage = `url('${mode.background}')`;
                    updateDisplay();
                }

                function countdown() {
                    if (isPaused) return;
                    if (remainingSeconds > 0) {
                        remainingSeconds--;
                        updateDisplay();
                    } else {
                        clearInterval(timer);
                        isPaused = true;
                        playIcon.classList.remove('hidden');
                        pauseIcon.classList.add('hidden');
                        
                        if (currentMode === 'pomodoro') {
                            sessionCount++;
                            sessionCountDisplay.textContent = sessionCount;
                        }

                        alert(`${modes[currentMode].name} session is over!`);
                        setMode(modes[currentMode].next);
                    }
                }

                playPauseBtn.addEventListener('click', () => {
                    isPaused = !isPaused;
                    if (!isPaused) {
                        timer = setInterval(countdown, 1000);
                        playIcon.classList.add('hidden');
                        pauseIcon.classList.remove('hidden');
                    } else {
                        clearInterval(timer);
                        playIcon.classList.remove('hidden');
                        pauseIcon.classList.add('hidden');
                    }
                });

                switchModeBtn.addEventListener('click', () => {
                    isPaused = true;
                    clearInterval(timer);
                    playIcon.classList.remove('hidden');
                    pauseIcon.classList.add('hidden');
                    setMode(modes[currentMode].next);
                });
                
                setMode('pomodoro'); // Initialize
            }

            function setupWeeklyGoals() {
                const taskBoard = document.querySelector('#weekly-goals .task-board');
                const modal = document.getElementById('add-task-modal');
                const modalTitle = document.getElementById('modal-title');
                const modalInput = document.getElementById('modal-task-input');
                const modalCancelBtn = document.getElementById('modal-cancel-btn');
                const modalSaveBtn = document.getElementById('modal-save-btn');
                const aiBreakdownBtn = document.getElementById('ai-breakdown-btn');
                const aiBreakdownLoader = document.getElementById('ai-breakdown-loader');
                const aiBreakdownBtnText = document.getElementById('ai-breakdown-btn-text');
                let currentTaskList;

                const columns = ['Daily Tasks', 'Routine Tasks', 'Work Tasks', 'Hobbies', 'Others'];
                
                columns.forEach(colName => {
                    const columnEl = document.createElement('div');
                    columnEl.className = 'task-column';
                    columnEl.innerHTML = `
                        <h3 class="font-bold mb-4 text-slate-800">${colName}</h3>
                        <div class="task-list space-y-3 mb-4"></div>
                        <button class="add-task-btn w-full p-2 text-sm text-slate-600 hover:bg-slate-200 rounded-md">+ Add a task</button>
                    `;
                    taskBoard.appendChild(columnEl);
                });

                function addTaskToUI(taskText, list) {
                     const taskEl = document.createElement('div');
                    taskEl.className = 'task-item';
                    const taskId = `task-${Date.now()}-${Math.random()}`;
                    taskEl.innerHTML = `
                        <div class="flex items-center">
                            <input type="checkbox" id="${taskId}" class="task-item-checkbox hidden">
                            <label for="${taskId}" class="flex items-center cursor-pointer text-slate-700 w-full">
                                <span class="w-5 h-5 mr-3 rounded-full border-2 border-slate-300 flex-shrink-0 flex items-center justify-center">
                                     <svg class="w-3 h-3 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                </span>
                                ${taskText}
                            </label>
                        </div>
                    `;
                    list.appendChild(taskEl);
                }

                taskBoard.addEventListener('click', e => {
                    if (e.target.classList.contains('add-task-btn')) {
                        modal.style.display = 'flex';
                        modalTitle.textContent = `Add to ${e.target.previousElementSibling.previousElementSibling.textContent}`;
                        currentTaskList = e.target.previousElementSibling;
                        modalInput.focus();
                    }
                });

                modalCancelBtn.addEventListener('click', () => {
                    modal.style.display = 'none';
                    modalInput.value = '';
                });

                modalSaveBtn.addEventListener('click', () => {
                    const taskText = modalInput.value.trim();
                    if (taskText) {
                       addTaskToUI(taskText, currentTaskList);
                    }
                    modal.style.display = 'none';
                    modalInput.value = '';
                });

                aiBreakdownBtn.addEventListener('click', async () => {
                    const goal = modalInput.value.trim();
                    if (!goal) {
                        alert("Please enter a goal to break down.");
                        return;
                    }
                    
                    aiBreakdownBtnText.classList.add('hidden');
                    aiBreakdownLoader.classList.remove('hidden');

                    const prompt = `Break down the following high-level goal into a list of smaller, actionable sub-tasks. The goal is: "${goal}". Return the response as a JSON object with a single key "tasks" which is an array of strings.`;
                    
                    try {
                        let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = { 
                            contents: chatHistory,
                             generationConfig: {
                                responseMimeType: "application/json",
                                responseSchema: {
                                    type: "OBJECT",
                                    properties: { "tasks": { "type": "ARRAY", "items": { "type": "STRING" } } }
                                }
                            }
                        };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        const result = await response.json();
                        
                        if (result.candidates && result.candidates[0].content.parts[0].text) {
                            const parsed = JSON.parse(result.candidates[0].content.parts[0].text);
                            parsed.tasks.forEach(task => addTaskToUI(task, currentTaskList));
                            modal.style.display = 'none';
                            modalInput.value = '';
                        } else {
                            throw new Error("Invalid response from API");
                        }
                    } catch (error) {
                        console.error("Error with Gemini API:", error);
                        alert("Could not break down the task. Please try adding it manually.");
                    } finally {
                        aiBreakdownBtnText.classList.remove('hidden');
                        aiBreakdownLoader.classList.add('hidden');
                    }
                });

                 taskBoard.addEventListener('change', e => {
                    if (e.target.classList.contains('task-item-checkbox')) {
                        const label = e.target.nextElementSibling;
                        if (e.target.checked) {
                            label.classList.add('line-through', 'text-gray-500');
                        } else {
                             label.classList.remove('line-through', 'text-gray-500');
                        }
                    }
                });
            }
            
            function setupDissertationPage() {
                const aiResearchBtn = document.getElementById('ai-research-btn');
                const aiResearchBtnText = document.getElementById('ai-research-btn-text');
                const aiResearchLoader = document.getElementById('ai-research-loader');
                const aiResearchQuery = document.getElementById('ai-research-query');
                const aiResearchOutput = document.getElementById('ai-research-output');

                aiResearchBtn.addEventListener('click', async () => {
                    const query = aiResearchQuery.value.trim();
                    if (!query) {
                        alert("Please enter a research query.");
                        return;
                    }

                    aiResearchBtnText.classList.add('hidden');
                    aiResearchLoader.classList.remove('hidden');
                    aiResearchOutput.innerHTML = '';

                    const prompt = `Act as a research assistant. Provide a concise summary and key insights for the following query: "${query}"`;

                    try {
                        let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = { contents: chatHistory };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        const result = await response.json();

                        if (result.candidates && result.candidates[0].content.parts[0].text) {
                            aiResearchOutput.textContent = result.candidates[0].content.parts[0].text;
                        } else {
                             throw new Error("Invalid response from API");
                        }
                    } catch (error) {
                        console.error("Error with Gemini API:", error);
                        aiResearchOutput.textContent = "Sorry, I couldn't fetch insights for that query. Please try again.";
                    } finally {
                        aiResearchBtnText.classList.remove('hidden');
                        aiResearchLoader.classList.add('hidden');
                    }
                });
            }

            function setupShiftTimer() {
                const shiftTimerPage = document.getElementById('shift-timer');
                const setupView = document.getElementById('shift-setup');
                const countdownView = document.getElementById('shift-countdown-display');
                const endView = document.getElementById('shift-end-message');
                const startBtn = document.getElementById('start-shift-btn');
                const resetBtn = document.getElementById('reset-shift-btn');
                const newShiftBtn = document.getElementById('new-shift-btn');
                const endTimeInput = document.getElementById('shift-end-time-input');
                const endTimeLabel = document.getElementById('shift-end-time-label');
                const shiftProgressBar = document.getElementById('shift-progress-bar');
                const presetNormalBtn = document.getElementById('preset-normal-btn');
                const presetOvertimeBtn = document.getElementById('preset-overtime-btn');

                let shiftTimer;
                let shiftStartTime;
                let shiftEndTime;
                let totalShiftDuration;
                let activeAnimationId;
                
                const canvas = document.getElementById('shift-timer-canvas');
                const ctx = canvas.getContext('2d');
                const mouse = { x: null, y: null, radius: 150 };
                
                function formatDateTimeForInput(date) {
                    const pad = (num) => num.toString().padStart(2, '0');
                    return `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())}T${pad(date.getHours())}:${pad(date.getMinutes())}`;
                }

                presetNormalBtn.addEventListener('click', () => {
                    const nextDay = new Date();
                    nextDay.setDate(nextDay.getDate() + 1);
                    nextDay.setHours(7, 0, 0, 0);
                    endTimeInput.value = formatDateTimeForInput(nextDay);
                });

                presetOvertimeBtn.addEventListener('click', () => {
                    const nextDay = new Date();
                    nextDay.setDate(nextDay.getDate() + 1);
                    nextDay.setHours(5, 0, 0, 0);
                    endTimeInput.value = formatDateTimeForInput(nextDay);
                });

                function updateShiftDisplay(remainingMs) {
                    const h = Math.floor(remainingMs / (1000 * 60 * 60));
                    const m = Math.floor((remainingMs % (1000 * 60 * 60)) / (1000 * 60));
                    const s = Math.floor((remainingMs % (1000 * 60)) / 1000);

                    document.getElementById('shift-hours-display').textContent = h.toString().padStart(2, '0');
                    document.getElementById('shift-minutes-display').textContent = m.toString().padStart(2, '0');
                    document.getElementById('shift-seconds-display').textContent = s.toString().padStart(2, '0');
                }

                function updateShiftVisuals() {
                    const now = new Date();
                    const elapsedMs = now - shiftStartTime;
                    const percentage = (elapsedMs / totalShiftDuration) * 100;
                    shiftProgressBar.style.width = `${Math.min(percentage, 100)}%`;
                }

                function shiftCountdown() {
                    const now = new Date();
                    const remainingMs = shiftEndTime - now;

                    if (remainingMs > 0) {
                        updateShiftDisplay(remainingMs);
                        updateShiftVisuals();
                    } else {
                        clearInterval(shiftTimer);
                        updateShiftDisplay(0);
                        countdownView.classList.add('hidden');
                        endView.classList.remove('hidden');
                        stopActiveAnimation();
                        localStorage.removeItem('shiftEndTime');
                        localStorage.removeItem('shiftStartTime');
                    }
                }

                function resetShiftTimer() {
                    clearInterval(shiftTimer);
                    stopActiveAnimation();
                    localStorage.removeItem('shiftEndTime');
                    localStorage.removeItem('shiftStartTime');
                    setupView.classList.remove('hidden');
                    countdownView.classList.add('hidden');
                    endView.classList.add('hidden');
                }

                function checkStoredShift() {
                    const storedEndTime = localStorage.getItem('shiftEndTime');
                    const storedStartTime = localStorage.getItem('shiftStartTime');

                    if (storedEndTime && storedStartTime) {
                        shiftEndTime = new Date(storedEndTime);
                        shiftStartTime = new Date(storedStartTime);
                        
                        if (shiftEndTime > new Date()) {
                            totalShiftDuration = shiftEndTime - shiftStartTime;
                            setupView.classList.add('hidden');
                            countdownView.classList.remove('hidden');
                            endTimeLabel.textContent = `Ends at ${shiftEndTime.toLocaleTimeString()}`;
                            shiftCountdown();
                            shiftTimer = setInterval(shiftCountdown, 1000);
                            startRandomAnimation();
                        } else {
                            resetShiftTimer();
                        }
                    } else {
                        resetShiftTimer();
                    }
                }

                startBtn.addEventListener('click', () => {
                    const endTimeValue = endTimeInput.value;
                    if (!endTimeValue) {
                        alert("Please select an end date and time.");
                        return;
                    }
                    
                    shiftStartTime = new Date();
                    shiftEndTime = new Date(endTimeValue);

                    if (shiftEndTime <= shiftStartTime) {
                        alert("End time must be in the future.");
                        return;
                    }

                    localStorage.setItem('shiftStartTime', shiftStartTime.toISOString());
                    localStorage.setItem('shiftEndTime', shiftEndTime.toISOString());

                    totalShiftDuration = (shiftEndTime - shiftStartTime);
                    
                    setupView.classList.add('hidden');
                    countdownView.classList.remove('hidden');
                    
                    endTimeLabel.textContent = `Ends at ${shiftEndTime.toLocaleTimeString()}`;
                    
                    shiftCountdown(); // Initial call
                    shiftTimer = setInterval(shiftCountdown, 1000);
                    startRandomAnimation();
                });

                resetBtn.addEventListener('click', resetShiftTimer);
                newShiftBtn.addEventListener('click', resetShiftTimer);
                
                // Animation Functions
                const animations = [initDigitalRain, initConstellation];
                let currentAnimationId;

                function startRandomAnimation() {
                    stopActiveAnimation();
                    const randomIndex = Math.floor(Math.random() * animations.length);
                    animations[randomIndex]();
                }

                function stopActiveAnimation() {
                    if (currentAnimationId) {
                        cancelAnimationFrame(currentAnimationId);
                    }
                    window.removeEventListener('resize', resizeCanvas);
                    shiftTimerPage.removeEventListener('mousemove', ()=>{});
                    shiftTimerPage.removeEventListener('mouseout', ()=>{});
                }

                function resizeCanvas() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }

                function initDigitalRain() {
                    let columns;
                    let fontSize = 16;
                    let drops = [];
                    const characters = '„Ç¢„Ç°„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É£„É©„ÉØ„Ç¨„Ç∂„ÉÄ„Éê„Éë„Ç§„Ç£„Ç≠„Ç∑„ÉÅ„Éã„Éí„Éü„É™„É∞„ÇÆ„Ç∏„ÉÇ„Éì„Éî„Ç¶„Ç•„ÇØ„Çπ„ÉÑ„Éå„Éï„É†„É¶„É•„É´„Ç∞„Ç∫„Éñ„ÉÖ„Éó„Ç®„Çß„Ç±„Çª„ÉÜ„Éç„Éò„É°„É¨„É±„Ç≤„Çº„Éá„Éô„Éö„Ç™„Ç©„Ç≥„ÇΩ„Éà„Éé„Éõ„É¢„É®„Éß„É≠„É≤„Ç¥„Çæ„Éâ„Éú„Éù„É¥„ÉÉ„É≥0123456789';

                    function localResize() {
                        resizeCanvas();
                        columns = Math.floor(canvas.width / fontSize);
                        for(let i = 0; i < columns; i++) {
                            drops[i] = 1;
                        }
                    }
                    localResize();
                    window.addEventListener('resize', localResize);
                    
                    shiftTimerPage.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
                    shiftTimerPage.addEventListener('mouseout', () => { mouse.x = null; mouse.y = null; });

                    function draw() {
                        ctx.fillStyle = 'rgba(17, 24, 39, 0.1)';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        for(let i = 0; i < drops.length; i++) {
                            const text = characters.charAt(Math.floor(Math.random() * characters.length));
                            const x = i * fontSize;
                            const y = drops[i] * fontSize;

                            let dx = mouse.x - x;
                            let dy = mouse.y - y;
                            let distance = dx * dx + dy * dy;

                            if (distance < mouse.radius) {
                                ctx.fillStyle = '#a7f3d0'; // emerald-200
                                ctx.font = `${fontSize + 2}px monospace`;
                            } else {
                                ctx.fillStyle = '#059669'; // emerald-600
                                ctx.font = `${fontSize}px monospace`;
                            }
                            
                            ctx.fillText(text, x, y);
                            
                            if(y > canvas.height && Math.random() > 0.975) {
                                drops[i] = 0;
                            }
                            drops[i]++;
                        }
                    }
                    
                    function animate() {
                        draw();
                        currentAnimationId = requestAnimationFrame(animate);
                    }
                    animate();
                }

                function initConstellation() {
                    let particles = [];
                    const numParticles = 100;
                    
                    function localResize() {
                        resizeCanvas();
                        particles = [];
                        for(let i = 0; i < numParticles; i++) {
                            particles.push({
                                x: Math.random() * canvas.width,
                                y: Math.random() * canvas.height,
                                vx: Math.random() * 0.4 - 0.2,
                                vy: Math.random() * 0.4 - 0.2,
                                radius: Math.random() * 1.5 + 1
                            });
                        }
                    }
                    localResize();
                    window.addEventListener('resize', localResize);
                    
                    shiftTimerPage.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
                    shiftTimerPage.addEventListener('mouseout', () => { mouse.x = null; mouse.y = null; });

                    function draw() {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        ctx.fillStyle = '#111827';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);

                        for(let i = 0; i < particles.length; i++) {
                            const p = particles[i];
                            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                            ctx.beginPath();
                            ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                            ctx.fill();

                            p.x += p.vx;
                            p.y += p.vy;

                            if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                            if (p.y < 0 || p.y > canvas.height) p.vy *= -1;

                            for(let j = i + 1; j < particles.length; j++) {
                                const p2 = particles[j];
                                const dx = p.x - p2.x;
                                const dy = p.y - p2.y;
                                const dist = Math.sqrt(dx * dx + dy * dy);

                                if (dist < 120) {
                                    ctx.beginPath();
                                    ctx.moveTo(p.x, p.y);
                                    ctx.lineTo(p2.x, p2.y);
                                    ctx.strokeStyle = `rgba(255, 255, 255, ${1 - dist/120})`;
                                    ctx.lineWidth = 0.5;
                                    ctx.stroke();
                                }
                            }
                            
                            if (mouse.x) {
                                const mdx = p.x - mouse.x;
                                const mdy = p.y - mouse.y;
                                const mDist = Math.sqrt(mdx*mdx + mdy*mdy);
                                if (mDist < 150) {
                                     ctx.beginPath();
                                    ctx.moveTo(p.x, p.y);
                                    ctx.lineTo(mouse.x, mouse.y);
                                    ctx.strokeStyle = `rgba(250, 204, 21, ${1 - mDist/150})`;
                                    ctx.lineWidth = 0.5;
                                    ctx.stroke();
                                }
                            }
                        }
                    }

                    function animate() {
                        draw();
                        currentAnimationId = requestAnimationFrame(animate);
                    }
                    animate();
                }

                checkStoredShift();
            }
            
            function initLandingPageAnimation() {
                const canvas = landingCanvas;
                const ctx = canvas.getContext('2d');
                let particles = [];
                const mouse = { x: null, y: null, radius: 100 };

                window.addEventListener('mousemove', (event) => {
                    mouse.x = event.x;
                    mouse.y = event.y;
                });
                window.addEventListener('mouseout', () => {
                    mouse.x = null;
                    mouse.y = null;
                });


                function resizeCanvas() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
                resizeCanvas();
                window.addEventListener('resize', resizeCanvas);

                class Particle {
                    constructor() {
                        this.x = Math.random() * canvas.width;
                        this.y = Math.random() * canvas.height;
                        this.baseX = this.x;
                        this.baseY = this.y;
                        this.size = Math.random() * 2.5 + 1;
                        this.density = (Math.random() * 30) + 1;
                        this.color = `rgba(139, 92, 246, ${Math.random() * 0.5 + 0.2})`;
                    }
                    update() {
                        let dx = mouse.x - this.x;
                        let dy = mouse.y - this.y;
                        let distance = Math.sqrt(dx * dx + dy * dy);
                        let forceDirectionX = dx / distance;
                        let forceDirectionY = dy / distance;
                        let maxDistance = mouse.radius;
                        let force = (maxDistance - distance) / maxDistance;
                        let directionX = forceDirectionX * force * this.density;
                        let directionY = forceDirectionY * force * this.density;

                        if (distance < mouse.radius) {
                            this.x -= directionX;
                            this.y -= directionY;
                        } else {
                            if (this.x !== this.baseX) {
                                let dx = this.x - this.baseX;
                                this.x -= dx / 10;
                            }
                            if (this.y !== this.baseY) {
                                let dy = this.y - this.baseY;
                                this.y -= dy / 10;
                            }
                        }
                    }
                    draw() {
                        ctx.fillStyle = this.color;
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }

                function initParticles() {
                    particles = [];
                    for (let i = 0; i < 150; i++) {
                        particles.push(new Particle());
                    }
                }
                initParticles();

                function animate() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    for (let i = 0; i < particles.length; i++) {
                        particles[i].update();
                        particles[i].draw();
                    }
                    requestAnimationFrame(animate);
                }
                animate();
            }
            initLandingPageAnimation();

        });

        function renderTimelineChart() {
            const ctx = document.getElementById('timelineChart').getContext('2d');
            if (window.myTimelineChart) {
                window.myTimelineChart.destroy();
            }
            window.myTimelineChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Immersive Tech', 'AI & ML', 'Advanced Web', 'Mobile Tech', 'Cyber Security'],
                    datasets: [{
                        label: 'Learning Path',
                        data: [
                            [0, 3], 
                            [3, 5],
                            [5, 7],
                            [7, 9],
                            [9, 12]
                        ],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.5)',
                            'rgba(139, 92, 246, 0.5)',
                            'rgba(16, 185, 129, 0.5)',
                            'rgba(245, 158, 11, 0.5)',
                            'rgba(244, 63, 94, 0.5)'
                        ],
                        borderColor: [
                            'rgba(59, 130, 246, 1)',
                            'rgba(139, 92, 246, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(245, 158, 11, 1)',
                            'rgba(244, 63, 94, 1)'
                        ],
                        borderWidth: 1,
                        barPercentage: 0.6,
                        borderSkipped: false,
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    return `Weeks ${value[0]} - ${value[1]}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            min: 0,
                            max: 12,
                            title: {
                                display: true,
                                text: 'Weeks'
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        function setupHourCalculator() {
            const timeEntriesContainer = document.getElementById('time-entries');
            const addRowBtn = document.getElementById('add-time-row');
            const calculateBtn = document.getElementById('calculate-time-btn');
            const clearBtn = document.getElementById('clear-time-btn');
            const printBtn = document.getElementById('print-time-btn');
            const totalHms = document.getElementById('total-time-hms');
            const totalDecimal = document.getElementById('total-time-decimal');

            function createTimeRow() {
                const row = document.createElement('div');
                row.className = 'flex items-center space-x-2';
                row.innerHTML = `
                    <input type="number" class="time-input w-16 p-2 border rounded-md text-center dark:bg-gray-700 dark:text-white" placeholder="00" min="0">
                    <span class="font-bold">:</span>
                    <input type="number" class="time-input w-16 p-2 border rounded-md text-center dark:bg-gray-700 dark:text-white" placeholder="00" min="0" max="59">
                    <span class="font-bold">:</span>
                    <input type="number" class="time-input w-16 p-2 border rounded-md text-center dark:bg-gray-700 dark:text-white" placeholder="00" min="0" max="59">
                `;
                timeEntriesContainer.appendChild(row);
            }

            addRowBtn.addEventListener('click', createTimeRow);

            calculateBtn.addEventListener('click', () => {
                let totalSeconds = 0;
                const rows = timeEntriesContainer.querySelectorAll('.flex');
                rows.forEach(row => {
                    const inputs = row.querySelectorAll('.time-input');
                    const hours = parseInt(inputs[0].value) || 0;
                    const minutes = parseInt(inputs[1].value) || 0;
                    const seconds = parseInt(inputs[2].value) || 0;
                    totalSeconds += (hours * 3600) + (minutes * 60) + seconds;
                });

                const totalHours = Math.floor(totalSeconds / 3600);
                const totalMinutes = Math.floor((totalSeconds % 3600) / 60);
                const remainingSeconds = totalSeconds % 60;

                totalHms.textContent = `${totalHours.toString().padStart(2, '0')}:${totalMinutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
                totalDecimal.textContent = (totalSeconds / 3600).toFixed(2);
            });

            clearBtn.addEventListener('click', () => {
                timeEntriesContainer.innerHTML = '';
                for(let i=0; i<5; i++) createTimeRow();
                totalHms.textContent = '00:00:00';
                totalDecimal.textContent = '0.00';
            });
            
            printBtn.addEventListener('click', () => {
                window.print();
            });

            // Initial rows
            for(let i=0; i<5; i++) createTimeRow();
        }
        
        function setupIdeaBoard() {
            const ideaBoard = document.getElementById('idea-board');
            const addNoteBtn = document.getElementById('add-note-btn');
            const ideaBoardContainer = document.getElementById('idea-board-container');
            let notes = JSON.parse(localStorage.getItem('sticky-notes')) || [];
            let activeNote = null;
            let offsetX, offsetY;

            const colors = ['bg-yellow-200', 'bg-green-200', 'bg-pink-200', 'bg-blue-200', 'bg-purple-200'];

            function saveNotes() {
                localStorage.setItem('sticky-notes', JSON.stringify(notes));
            }

            function createNoteElement(note) {
                const noteEl = document.createElement('div');
                noteEl.id = note.id;
                noteEl.className = `sticky-note absolute w-60 h-60 p-4 flex flex-col ${note.color}`;
                noteEl.style.left = `${note.x}px`;
                noteEl.style.top = `${note.y}px`;
                noteEl.innerHTML = `
                    <div class="flex-grow overflow-auto">
                        <textarea class="w-full h-full bg-transparent resize-none focus:outline-none text-gray-800">${note.content}</textarea>
                    </div>
                    <div class="flex justify-end items-center mt-2 space-x-2">
                        <button class="copy-note-btn text-gray-600 hover:text-black">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                        </button>
                        <button class="delete-note-btn text-gray-600 hover:text-red-500">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                        </button>
                    </div>
                `;
                ideaBoardContainer.appendChild(noteEl);

                noteEl.addEventListener('mousedown', (e) => {
                    if (e.target.tagName.toLowerCase() === 'textarea') return;
                    activeNote = noteEl;
                    activeNote.classList.add('dragging');
                    offsetX = e.clientX - noteEl.offsetLeft;
                    offsetY = e.clientY - noteEl.offsetTop;
                });

                const textarea = noteEl.querySelector('textarea');
                textarea.addEventListener('input', () => {
                    const noteToUpdate = notes.find(n => n.id === note.id);
                    noteToUpdate.content = textarea.value;
                    saveNotes();
                });

                noteEl.querySelector('.delete-note-btn').addEventListener('click', () => {
                    notes = notes.filter(n => n.id !== note.id);
                    saveNotes();
                    noteEl.remove();
                });

                noteEl.querySelector('.copy-note-btn').addEventListener('click', (e) => {
                     const button = e.currentTarget;
                     const originalIcon = button.innerHTML;
                     const checkIcon = `<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`;
                     
                     const tempInput = document.createElement('textarea');
                     tempInput.value = textarea.value;
                     document.body.appendChild(tempInput);
                     tempInput.select();
                     document.execCommand('copy');
                     document.body.removeChild(tempInput);

                     button.innerHTML = checkIcon;
                     setTimeout(() => {
                        button.innerHTML = originalIcon;
                     }, 1500)
                });
            }

            document.addEventListener('mousemove', (e) => {
                if (!activeNote) return;
                activeNote.style.left = `${e.clientX - offsetX}px`;
                activeNote.style.top = `${e.clientY - offsetY}px`;
            });

            document.addEventListener('mouseup', () => {
                if (activeNote) {
                    const noteToUpdate = notes.find(n => n.id === activeNote.id);
                    noteToUpdate.x = activeNote.offsetLeft;
                    noteToUpdate.y = activeNote.offsetTop;
                    saveNotes();
                    activeNote.classList.remove('dragging');
                }
                activeNote = null;
            });

            addNoteBtn.addEventListener('click', () => {
                const newNote = {
                    id: `note-${Date.now()}`,
                    content: '',
                    color: colors[Math.floor(Math.random() * colors.length)],
                    x: Math.random() * (ideaBoard.offsetWidth - 240),
                    y: Math.random() * (ideaBoard.offsetHeight - 240)
                };
                notes.push(newNote);
                createNoteElement(newNote);
                saveNotes();
            });

            notes.forEach(createNoteElement);
        }
        
        function setupSettings() {
            const themeToggleBtn = document.getElementById('theme-toggle');
            const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
            const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

            // Change the icons inside the button based on previous settings
            if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                themeToggleLightIcon.classList.remove('hidden');
            } else {
                themeToggleDarkIcon.classList.remove('hidden');
            }

            themeToggleBtn.addEventListener('click', function() {
                // toggle icons inside button
                themeToggleDarkIcon.classList.toggle('hidden');
                themeToggleLightIcon.classList.toggle('hidden');

                // if set via local storage previously
                if (localStorage.getItem('color-theme')) {
                    if (localStorage.getItem('color-theme') === 'light') {
                        document.documentElement.classList.add('dark');
                        localStorage.setItem('color-theme', 'dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                        localStorage.setItem('color-theme', 'light');
                    }
                // if NOT set via local storage previously
                } else {
                    if (document.documentElement.classList.contains('dark')) {
                        document.documentElement.classList.remove('dark');
                        localStorage.setItem('color-theme', 'light');
                    } else {
                        document.documentElement.classList.add('dark');
                        localStorage.setItem('color-theme', 'dark');
                    }
                }
            });
        }
    </script>
</body>
</html>
